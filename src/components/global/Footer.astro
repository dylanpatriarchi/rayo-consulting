---
import { languages } from "@i18n/ui";
import { getLangFromUrl, getUrlWithoutLang, useTranslatedPath, useTranslations } from "@i18n/utils";

const currentLang = getLangFromUrl(Astro.url);
const path = getUrlWithoutLang(Astro.url);
const t = useTranslations(currentLang);
const translatePath = useTranslatedPath(currentLang);
---

<footer class="relative flex min-h-screen w-full flex-col gap-y-10 font-mono uppercase">
	<div class="relative flex-grow"></div>
	<div class="section gap-y-20">
		<!-- Navigation Links -->
		<div class="col-span-full col-start-1 sm:col-span-1 sm:col-start-1">
			<div class="flex flex-col gap-2 px-4">
				<a href={translatePath("/")} class="hover:text-gray-300 transition-colors">Home</a>
				<a href={translatePath("/projects")} class="hover:text-gray-300 transition-colors">{t("projects")}</a>
				<a href={translatePath("/services")} class="hover:text-gray-300 transition-colors">{t("services")}</a>
				<a href={translatePath("/contact/")} class="hover:text-gray-300 transition-colors">{t("contacts")}</a>
			</div>
		</div>

		<!-- Legal Links -->
		<div class="col-span-full col-start-1 sm:col-span-1 sm:col-start-2">
			<div class="flex flex-col gap-2 px-4">
				<a href={translatePath("/privacy/")} class="hover:text-gray-300 transition-colors">Privacy Policy</a>
				<a href={translatePath("/terms/")} class="hover:text-gray-300 transition-colors">Terms of Service</a>
				<a href={translatePath("/cookies/")} class="hover:text-gray-300 transition-colors">Cookie Policy</a>
			</div>
		</div>

		<!-- Social Media -->
		<div class="col-span-full col-start-1 flex flex-col gap-2 sm:col-span-1 sm:col-start-3">
			<a class="px-4 hover:text-gray-300 transition-colors" href="https://instagram.com/rayo.consulting" target="_blank">Instagram</a>
		</div>

		<!-- Contact Info -->
		<div class="col-span-full col-start-1 flex items-end py-3 sm:col-span-2 sm:col-start-1 sm:row-start-2 lg:text-xl">
			<a href="mailto:info@rayoconsulting.org" class="block cursor-pointer px-4 hover:text-gray-300 transition-colors">info@rayoconsulting.org</a>
		</div>

		<!-- Company Info -->
		<div class="relative col-span-full col-start-1 mt-4 flex w-full flex-col gap-2 py-3 text-sm sm:col-span-2 sm:col-start-3 sm:row-start-2 lg:text-base">
			<div class="px-4">
				<div class="mb-2">
					<strong>Rayo Consulting</strong><br>
					{currentLang === "it" ? "Patriarchi Dylan" : "Dylan Patriarchi"}<br>
					P.IVA: 03988190546<br>
					Città di Castello, Italia
				</div>
				<div class="text-xs text-gray-400">
					©2025 Rayo Consulting. {currentLang === "it" ? "Tutti i diritti riservati." : "All rights reserved."}
				</div>
			</div>
		</div>

		<!-- Language Switcher -->
		<div class="col-span-1 col-start-3 flex items-end gap-2 px-4 py-3 sm:col-span-1 sm:col-start-1 sm:row-start-3 lg:text-xl">
			{
				Object.entries(languages).map(([lang, label]) => (
					<a
						class:list={[
							"px-2 py-1 border transition-colors",
							currentLang == lang ? "bg-white text-black border-white" : "border-gray-600 hover:border-white"
						]}
						href={translatePath(path, `${currentLang === "it" ? "en" : "it"}`)}>
						{lang.toUpperCase()}
					</a>
				))
			}
		</div>

		<!-- Go to Top Button -->
		<button id="go-top-button" aria-label="Go to Top" class="col-span-1 col-start-4 flex items-end justify-end py-2 duration-300 sm:col-start-4 sm:row-start-3 hover:text-gray-300">
			<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24">
				<g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" fill="none">
					<path d="m15 12l-3-3m0 0l-3 3m3-3v6"></path>
				</g>
			</svg>
		</button>
	</div>
</footer>

<script>
	import { gsap } from "gsap";
	import { ScrollToPlugin } from "gsap/ScrollToPlugin";

	gsap.registerPlugin(ScrollToPlugin);

	function init() {
		var goTopButton = document.getElementById("go-top-button");

		if (!goTopButton) return;

		goTopButton.addEventListener("click", function () {
			gsap.to(window, { duration: 0.5, scrollTo: 0 });
		});
	}

	document.removeEventListener("DOMContentLoaded", init);
	document.addEventListener("DOMContentLoaded", init);
</script>
